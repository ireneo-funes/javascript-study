<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JavaScript Study</title>
  <link href="https://fonts.googleapis.com/css?family=Lato:400,900" rel="stylesheet">
  <style>
    body {
      font-family: 'Lato', sans-serif;
    }

    .target {
      color: red;
    }
  </style>
</head>

<body>
<div id='root'>
	<div>Child</div>
	<p class='target'>Child</p>
	<section>
		<input />
		<img src='error' class='target' />
		<code>/** TEST */</code>
	</section>
	<article>
		<div>123</div>
		<div>
			456
			<input type='password' class='target' />
			<a>
				<span>Deep</span>
			</a>
		</div>
		<div>789</div>
	</article>
</div>

<script>
  function DOMExplorer(rootID, containTarget) {
    var rootDOM = document.getElementById(rootID);
    var result = [];

    // Run iterative-DFS to visit all the descendants of the root DOM
    // Refer to https://en.wikipedia.org/wiki/Depth-first_search#Pseudocode
    var stack = [];
    stack.push(rootDOM);

    while (stack.length > 0) {
      const curr = stack.pop();
      // mark the current element if it has the desired class
      if (containTarget(curr)) {
        result.push(curr.outerHTML);
      }
      // take care of the children of the current element
      for (var i = 0; i < curr.childNodes.length; i++) {
        stack.push(curr.childNodes[i]);
      }
    }

    return result;
  }

  console.log(DOMExplorer('root', currentElement => {
  	if (currentElement.className === 'target')
      return true;
    else
      return false;
  }));
</script>
</body>
</html>
